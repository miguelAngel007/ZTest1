       IDENTIFICATION DIVISION.
       PROGRAM-ID. CDCCTDNI.

       ENVIRONMENT DIVISION.

       DATA DIVISION.
       WORKING-STORAGE SECTION.

       01  TABLA-DNI.
           05  DNI-ITEM      PIC X(8) OCCURS 5 TIMES
               INDEXED BY IDX-DNI.
       01  CANTIDAD-DNI      PIC 9(1) VALUE 5.
       01  DNI-INGRESADO     PIC X(8).
       01  ENCONTRADO        PIC X VALUE 'N'.

       01  WS-MSG-ENTRADA    PIC X(40) VALUE 'Ingrese DNI:'.
       01  WS-LONG-IN        PIC S9(4) COMP VALUE 8.
       01  WS-MSG-SALIDA     PIC X(40).

       PROCEDURE DIVISION.
       MAIN-PROCEDURE.

           MOVE '12345679' TO DNI-ITEM(1)
           MOVE '87654321' TO DNI-ITEM(2)
           MOVE '11112222' TO DNI-ITEM(3)
           MOVE '33334444' TO DNI-ITEM(4)
           MOVE '55556666' TO DNI-ITEM(5)

           EXEC CICS SEND
               FROM(WS-MSG-ENTRADA)
               LENGTH(13)
               ERASE
           END-EXEC

           EXEC CICS RECEIVE
               INTO(DNI-INGRESADO)
               LENGTH(WS-LONG-IN)
           END-EXEC

           PERFORM VARYING IDX-DNI FROM 1 BY 1
           UNTIL IDX-DNI > CANTIDAD-DNI
               IF DNI-INGRESADO = DNI-ITEM(IDX-DNI)
                   MOVE 'S' TO ENCONTRADO
                   EXIT PERFORM
               END-IF
           END-PERFORM

           IF ENCONTRADO = 'S'
               MOVE 'DNI encontrado.' TO WS-MSG-SALIDA
           ELSE
               MOVE 'DNI no existe.' TO WS-MSG-SALIDA
           END-IF

           EXEC CICS SEND
               FROM(WS-MSG-SALIDA)
               LENGTH(20)
               ERASE
           END-EXEC

           EXEC CICS RETURN
           END-EXEC.

       END PROGRAM CDCCTDNI.
